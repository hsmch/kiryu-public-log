---
import Layout from '../../layouts/Layout.astro';
import { getTagCounts, getTags } from '../../lib/data';

export const prerender = true;

const tagCounts = getTagCounts();
const tags = getTags();
---

<Layout title="テーマ別 - Kiryu Public Log">
  <div class="mx-auto max-w-4xl px-4 py-8">
    <h1 class="text-2xl font-bold text-gray-900">テーマ別</h1>
    <p class="mt-2 text-sm text-gray-500">
      議案や一般質問をテーマごとに分類しています
    </p>

    <div class="mt-2 rounded border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800">
      キーワードによる自動分類です。分類の正確性には限界があります。
      {tags?.method === 'rule-based' && ' ルールベースのキーワードマッチングで分類しています。'}
    </div>

    {tagCounts.length > 0 ? (
      <div class="mt-6 grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
        {tagCounts.map(({ tag, count }) => (
          <a
            href={`/topics/${encodeURIComponent(tag)}`}
            class="rounded-lg border border-gray-200 bg-white px-4 py-3 transition hover:border-blue-300 hover:shadow-sm"
          >
            <p class="font-medium text-gray-900">{tag}</p>
            <p class="mt-1 text-sm text-gray-500">{count}件</p>
          </a>
        ))}
      </div>
    ) : (
      <p class="mt-8 text-gray-500">タグデータが見つかりませんでした。</p>
    )}
  </div>
</Layout>
